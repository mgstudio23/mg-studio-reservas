<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reservas MG STUDIO</title>
    <style>
        /* Estilos generales optimizados para m√≥vil */
        :root {
            --primary: #ff4b7d;
            --primary-light: #ff85a2;
            --primary-dark: #e62a5d;
            --secondary: #333333;
            --light: #ffffff;
            --gray-light: #f8f8f8;
            --gray: #eaeaea;
            --text: #333333;
        }
        
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text);
            background-color: #fbfbfb;
            font-size: 16px;
            line-height: 1.5;
            width: 100%;
        }
        
        .mg-container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            background: var(--light);
            overflow: hidden;
        }
        
        /* Encabezado */
        .mg-header {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: var(--light);
            padding: 20px 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .mg-header h1 {
            margin: 0;
            font-size: 22px;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }
        
        .mg-header p {
            margin: 8px 0 0;
            font-size: 14px;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }
        
        /* Tabs para m√≥vil */
        .mg-mobile-tabs {
            display: flex;
            background-color: var(--light);
            border-bottom: 1px solid var(--gray);
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }
        
        .mg-mobile-tabs::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        
        .mg-tab {
            padding: 15px;
            font-weight: bold;
            flex: 1;
            text-align: center;
            cursor: pointer;
            min-width: 100px;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .mg-tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        /* Contenido de las tabs */
        .mg-content-section {
            display: none;
            padding: 15px;
        }
        
        .mg-content-section.active {
            display: block;
        }
        
        /* Calendario optimizado para m√≥vil */
        .mg-calendar {
            background: var(--light);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .mg-calendar h3 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .mg-calendar .month-nav {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .month-nav button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 18px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .month-nav button:active {
            background-color: rgba(255, 75, 125, 0.1);
        }
        
        .mg-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            text-align: center;
        }
        
        .mg-calendar-day {
            padding: 10px 0;
            font-size: 14px;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .mg-calendar-header {
            font-weight: bold;
            color: var(--secondary);
        }
        
        .mg-day-available {
            background-color: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            font-weight: bold;
            cursor: pointer;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .mg-day-available:active {
            background-color: rgba(76, 175, 80, 0.2);
        }
        
        .mg-day-selected {
            background-color: rgba(255, 75, 125, 0.1);
            color: var(--primary);
            font-weight: bold;
            border: 1px solid var(--primary);
        }
        
        .mg-day-past {
            color: #BDBDBD;
        }
        
        .mg-day-empty {
            color: transparent;
        }
        
        /* Promociones */
        .mg-promotions {
            background: linear-gradient(135deg, #fff6f9, #fff);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .mg-promotions h3 {
            margin-top: 0;
            color: var(--primary);
            font-size: 16px;
        }
        
        .mg-promo-item {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed rgba(0,0,0,0.1);
            gap: 10px;
        }
        
        .mg-promo-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .mg-promo-icon {
            width: 36px;
            height: 36px;
            background-color: var(--primary-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .mg-promo-content {
            flex-grow: 1;
        }
        
        .mg-promo-title {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .mg-promo-desc {
            font-size: 13px;
            color: #666;
        }
        
        /* Tabla de horarios para m√≥vil */
        .mg-schedule-mobile {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .mg-day-header {
            background-color: var(--secondary);
            color: var(--light);
            padding: 12px 15px;
            border-radius: 10px 10px 0 0;
            font-size: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .mg-day-card {
            background: var(--light);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .mg-day-content {
            padding: 15px;
        }
        
        .mg-day-mobile {
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .mg-day-icon {
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Botones de horario optimizados para t√°ctil */
        .mg-time-slots {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .mg-time-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: var(--light);
            padding: 12px 16px;
            border-radius: 25px;
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(255, 75, 125, 0.3);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            gap: 6px;
            min-width: 110px;
            min-height: 44px; /* Para mejor √°rea t√°ctil */
        }
        
        .mg-time-btn:active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 75, 125, 0.4);
        }
        
        .mg-time-btn i {
            font-size: 14px;
        }
        
        .mg-time-btn-disabled {
            background: linear-gradient(135deg, #cccccc, #a0a0a0);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .mg-time-btn-disabled:active {
            transform: none;
            box-shadow: none;
        }
        
        .mg-time-btn-low {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }
        
        .mg-time-btn-low:active {
            background: linear-gradient(135deg, #f57c00, #ef6c00);
        }
        
        /* Informaci√≥n adicional */
        .mg-info {
            background-color: var(--gray-light);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-top: 15px;
            margin-bottom: 15px;
            border-radius: 0 10px 10px 0;
        }
        
        .mg-info h3 {
            margin-top: 0;
            color: var(--primary);
            font-size: 16px;
        }
        
        .mg-info ul {
            padding-left: 20px;
            margin-bottom: 0;
        }
        
        .mg-info li {
            margin-bottom: 8px;
            position: relative;
            font-size: 14px;
        }
        
        .mg-info li::before {
            content: "‚Ä¢";
            color: var(--primary);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
        
        /* Footer */
        .mg-footer {
            text-align: center;
            padding: 20px 15px;
            background-color: var(--secondary);
            color: var(--light);
            font-size: 14px;
        }
        
        .mg-footer a {
            color: var(--primary-light);
            text-decoration: none;
        }
        
        .mg-social {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .mg-social-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .mg-social-icon:active {
            background-color: var(--primary);
        }
        
        /* Modal optimizado para m√≥vil */
        .mg-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            overflow-y: auto;
        }
        
        .mg-modal-content {
            background-color: var(--light);
            margin: 5% auto;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from {opacity: 0; transform: translateY(-20px);}
            to {opacity: 1; transform: translateY(0);}
        }
        
        .mg-close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: -10px -10px 0 0;
        }
        
        .mg-close:active {
            color: var(--primary);
        }
        
        .mg-modal-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }
        
        .mg-modal-header h3 {
            margin: 0 0 5px 0;
            color: var(--secondary);
            font-size: 18px;
        }
        
        .mg-modal-details {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background-color: var(--gray-light);
            padding: 12px;
            border-radius: 8px;
        }
        
        .mg-modal-detail {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .mg-modal-detail i {
            color: var(--primary);
        }
        
        .mg-service-select {
            width: 100%;
            padding: 12px;
            margin: 20px 0;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s ease;
            background-color: white;
            -webkit-appearance: none;
            appearance: none;
            height: 48px;
        }
        
        .mg-service-select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 75, 125, 0.2);
        }
        
        .mg-confirm-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            height: 48px;
        }
        
        .mg-confirm-btn:active {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-dark));
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 75, 125, 0.4);
        }
        
        /* Indicador de disponibilidad */
        .mg-availability {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            margin-top: 5px;
        }
        
        .mg-availability.high {
            background-color: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
        }
        
        .mg-availability.medium {
            background-color: rgba(255, 152, 0, 0.1);
            color: #FF9800;
        }
        
        .mg-availability.low {
            background-color: rgba(244, 67, 54, 0.1);
            color: #F44336;
        }
        
        /* Bot√≥n flotante para m√≥vil */
        .mg-floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 900;
            cursor: pointer;
            display: none;
        }
        
        /* Scroll to top visible s√≥lo en m√≥vil */
        .mg-scroll-top {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            text-align: center;
            line-height: 40px;
            z-index: 900;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* Ajustes espec√≠ficos para m√≥vil */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            
            .mg-header h1 {
                font-size: 20px;
            }
            
            .mg-calendar-day {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            .mg-scroll-top {
                display: block;
            }
            
            .mg-modal-content {
                margin: 10% auto;
                width: 95%;
                padding: 15px;
            }
            
            .mg-floating-btn {
                display: flex;
            }
        }
        
        /* Estilos para el modal de confirmaci√≥n mejorado */
        .mg-progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .mg-progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--gray);
            z-index: 1;
        }

        .mg-progress-step {
            position: relative;
            background-color: var(--light);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 2;
            color: var(--secondary);
            border: 1px solid var(--gray);
        }

        .mg-progress-step.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }

        .mg-progress-step.completed {
            background-color: var(--primary-dark);
            color: white;
            border-color: var(--primary-dark);
        }

        .mg-step-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .mg-step-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mg-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--secondary);
        }

        .mg-input, .mg-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .mg-input:focus, .mg-textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 75, 125, 0.2);
        }

        .mg-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .mg-button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .mg-back-btn {
            flex: 1;
            padding: 15px;
            background: var(--gray-light);
            color: var(--secondary);
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            height: 48px;
        }

        .mg-back-btn:active {
            background: var(--gray);
        }

        .mg-confirm-btn {
            flex: 2;
        }

        .mg-modal-note {
            background-color: rgba(255, 248, 225, 0.5);
            border-left: 3px solid #FFC107;
            padding: 10px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
        }

        .mg-modal-info {
            background-color: rgba(232, 245, 253, 0.5);
            border-left: 3px solid #03A9F4;
            padding: 10px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
        }

        .mg-icon {
            display: inline-block;
            margin-right: 5px;
        }

        .mg-summary {
            background-color: var(--gray-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .mg-summary h4 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--primary);
            border-bottom: 1px solid var(--gray);
            padding-bottom: 8px;
        }

        .mg-summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .mg-summary-label {
            font-weight: bold;
            color: var(--secondary);
        }

        .mg-summary-value {
            color: var(--text);
        }

        .mg-payment-methods h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .mg-payment-options {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .mg-payment-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Estados de disponibilidad y reserva para botones */
        .mg-time-btn-available {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
        }

        .mg-time-btn-reserved {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            color: white;
        }

        .mg-time-btn-pending {
            background: linear-gradient(135deg, #f39c12, #f1c40f);
            color: white;
        }

        .mg-time-btn-confirmed {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .mg-time-btn-unavailable {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: rgba(255, 255, 255, 0.7);
            cursor: not-allowed;
        }

        /* Dise√±o responsivo para el modal */
        @media (max-width: 768px) {
            .mg-progress-step {
                font-size: 10px;
                padding: 6px 8px;
            }
            
            .mg-modal-content {
                padding: 15px;
            }
            
            .mg-payment-options {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Estilos para mensajes de error */
        .mg-error-message {
            background-color: #ffebee;
            color: #c62828;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #c62828;
            font-size: 14px;
            animation: fadeIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="mg-container">
        <div class="mg-header">
            <h1>MG STUDIO - Reserva tu Cita</h1>
            <p>Luce Incre√≠ble, Si√©ntete √önica ‚ú®</p>
        </div>
        
        <!-- Tabs para m√≥vil -->
        <div class="mg-mobile-tabs">
            <div class="mg-tab active" onclick="showTab('horarios')">Horarios</div>
            <div class="mg-tab" onclick="showTab('calendario')">Calendario</div>
            <div class="mg-tab" onclick="showTab('promociones')">Promociones</div>
            <div class="mg-tab" onclick="showTab('info')">Info</div>
        </div>
        
        <!-- Secci√≥n de Calendario (Tab) -->
        <div id="calendario" class="mg-content-section">
            <div class="mg-calendar">
                <h3>
                    <div class="month-nav">
                        <button id="prevMonth">‚Üê</button>
                        <span>Mayo 2025</span>
                        <button id="nextMonth">‚Üí</button>
                    </div>
                </h3>
                <div class="mg-calendar-grid">
                    <!-- El calendario se generar√° din√°micamente aqu√≠ -->
                </div>
                <div style="margin-top: 10px; font-size: 12px; text-align: center;">
                    Haz clic en un d√≠a para ver los horarios disponibles
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n de Promociones (Tab) -->
        <div id="promociones" class="mg-content-section">
            <div class="mg-promotions">
                <h3>Promociones Especiales</h3>
                <div class="mg-promo-item">
                    <div class="mg-promo-icon">1</div>
                    <div class="mg-promo-content">
                        <div class="mg-promo-title">Lifting + Laminado</div>
                        <div class="mg-promo-desc">s/60 (¬°Ahorro s/15!) - Tratamiento completo para mirada perfecta</div>
                    </div>
                </div>
                <div class="mg-promo-item">
                    <div class="mg-promo-icon">2</div>
                    <div class="mg-promo-content">
                        <div class="mg-promo-title">Extensiones + Visagismo</div>
                        <div class="mg-promo-desc">s/70 (¬°Ahorro s/10!) - Mirada impactante y cejas perfectas</div>
                    </div>
                </div>
                <div class="mg-promo-item">
                    <div class="mg-promo-icon">3</div>
                    <div class="mg-promo-content">
                        <div class="mg-promo-title">Mam√° e Hija</div>
                        <div class="mg-promo-desc">25% de descuento cuando vienen juntas - Experiencia compartida</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n de Horarios (Tab) - Por defecto visible -->
        <div id="horarios" class="mg-content-section active">
            <!-- JUEVES 2 DE MAYO -->
            <div class="mg-day-card" data-day="Jueves 2 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">2</div>
                        Jueves
                    </div>
                    <div class="mg-availability high">Alta disponibilidad</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Jueves 2 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- VIERNES 3 DE MAYO -->
            <div class="mg-day-card" data-day="Viernes 3 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">3</div>
                        Viernes
                    </div>
                    <div class="mg-availability high">Alta disponibilidad</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Viernes 3 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- DOMINGO 4 DE MAYO -->
            <div class="mg-day-card" data-day="Domingo 4 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">4</div>
                        Domingo
                    </div>
                    <div class="mg-availability medium">Disponibilidad media</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Domingo 4 Mayo', '9:00 AM')">
                            <i>‚è∞</i> 9:00 AM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('Domingo 4 Mayo', '11:00 AM')">
                            <i>‚è∞</i> 11:00 AM
                        </button>
                        <button class="mg-time-btn mg-time-btn-disabled">
                            <i>üîí</i> 2:00 PM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('Domingo 4 Mayo', '5:00 PM')">
                            <i>‚è∞</i> 5:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- MARTES 6 DE MAYO -->
            <div class="mg-day-card" data-day="Martes 6 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">6</div>
                        Martes
                    </div>
                    <div class="mg-availability high">Alta disponibilidad</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Martes 6 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('Martes 6 Mayo', '5:00 PM')">
                            <i>‚è∞</i> 5:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- MI√âRCOLES 7 DE MAYO -->
            <div class="mg-day-card" data-day="Mi√©rcoles 7 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">7</div>
                        Mi√©rcoles
                    </div>
                    <div class="mg-availability high">Alta disponibilidad</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Mi√©rcoles 7 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('Mi√©rcoles 7 Mayo', '5:00 PM')">
                            <i>‚è∞</i> 5:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- JUEVES 8 DE MAYO -->
            <div class="mg-day-card" data-day="Jueves 8 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">8</div>
                        Jueves
                    </div>
                    <div class="mg-availability high">Alta disponibilidad</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('Jueves 8 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('Jueves 8 Mayo', '5:00 PM')">
                            <i>‚è∞</i> 5:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- VIERNES 9 DE MAYO -->
            <div class="mg-day-card" data-day="Viernes 9 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">9</div>
                        Viernes
                    </div>
                    <div class="mg-availability low">√öltimo espacio</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn mg-time-btn-disabled">
                            <i>üîí</i> 2:00 PM
                        </button>
                        <button class="mg-time-btn mg-time-btn-low" onclick="openModal('Viernes 9 Mayo', '5:00 PM')">
                            <i>‚è∞</i> 5:00 PM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- S√ÅBADO 10 DE MAYO -->
            <div class="mg-day-card" data-day="S√°bado 10 Mayo">
                <div class="mg-day-header">
                    <div class="mg-day-mobile">
                        <div class="mg-day-icon">10</div>
                        S√°bado
                    </div>
                    <div class="mg-availability medium">Disponibilidad media</div>
                </div>
                <div class="mg-day-content">
                    <div class="mg-time-slots">
                        <button class="mg-time-btn" onclick="openModal('S√°bado 10 Mayo', '9:00 AM')">
                            <i>‚è∞</i> 9:00 AM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('S√°bado 10 Mayo', '11:00 AM')">
                            <i>‚è∞</i> 11:00 AM
                        </button>
                        <button class="mg-time-btn" onclick="openModal('S√°bado 10 Mayo', '2:00 PM')">
                            <i>‚è∞</i> 2:00 PM
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n de Informaci√≥n (Tab) -->
        <div id="info" class="mg-content-section">
            <div class="mg-info">
                <h3>Informaci√≥n Importante</h3>
                <ul>
                    <li>Para confirmar tu cita es necesario un adelanto del 50%</li>
                    <li>Por favor, llega 5-10 minutos antes de tu hora programada</li>
                    <li>Ven sin maquillaje en la zona de ojos/cejas</li>
                    <li>Si necesitas cancelar, av√≠sanos con al menos 4 horas de anticipaci√≥n</li>
                </ul>
            </div>
            
            <div class="mg-info">
                <h3>Nuestros Servicios</h3>
                <ul>
                    <li><strong>Pesta√±as:</strong> Lifting (s/40), Extensiones Cl√°sicas (s/50), Efecto R√≠mel (s/60), Efecto Mojado (s/65), H√≠bridas (s/70)</li>
                    <li><strong>Volumen:</strong> Brasile√±o 2D (s/80), Hawaiano 3D (s/80), Griego 4D (s/80), Egipcio 5D (s/85), Mega Volumen 6D (s/110)</li>
                    <li><strong>Cejas:</strong> Visagismo (s/10), Depilaci√≥n con cera (s/15), Laminado (s/35), Pigmentaci√≥n (s/35)</li>
                </ul>
            </div>
        </div>
        
        <div class="mg-footer">
            <p>MG STUDIO | Jr. Bolognesi 265 | üì± 995 904 351</p>
            <div class="mg-social">
                <a href="https://www.instagram.com/mg.studio_pe" target="_blank" class="mg-social-icon">üì∏</a>
                <a href="https://wa.me/51995904351" target="_blank" class="mg-social-icon">üì±</a>
                <a href="#" class="mg-social-icon">üìç</a>
            </div>
        </div>
    </div>
    
    <!-- Modal para selecci√≥n de servicio -->
    <div id="serviceModal" class="mg-modal">
        <div class="mg-modal-content">
            <span class="mg-close" onclick="closeModal()">&times;</span>
            
            <!-- Encabezado del modal con progreso -->
            <div class="mg-modal-header">
                <div class="mg-progress-bar">
                    <div class="mg-progress-step active">1. Servicio</div>
                    <div class="mg-progress-step">2. Datos</div>
                    <div class="mg-progress-step">3. Confirmar</div>
                </div>
                <h3>Detalle de tu reserva</h3>
            </div>
            
            <!-- Secci√≥n 1: Selecci√≥n de servicio -->
            <div id="step-1" class="mg-step-section active">
                <div class="mg-modal-details">
                    <div class="mg-modal-detail">
                        <i class="mg-icon">üìÖ</i> <span id="selectedDay">D√≠a</span>
                    </div>
                    <div class="mg-modal-detail">
                        <i class="mg-icon">‚è∞</i> <span id="selectedTime">Hora</span>
                    </div>
                </div>
                
                <label for="serviceSelect" class="mg-label">Servicio:</label>
                <select id="serviceSelect" class="mg-service-select">
                    <optgroup label="Pesta√±as">
                        <option value="Lifting de Pesta√±as">Lifting de Pesta√±as - s/40</option>
                        <option value="Extensiones Cl√°sicas">Extensiones Cl√°sicas - s/50</option>
                        <option value="Efecto R√≠mel">Efecto R√≠mel - s/60</option>
                        <option value="Efecto Mojado">Efecto Mojado - s/65</option>
                        <option value="Extensiones H√≠bridas">Extensiones H√≠bridas - s/70</option>
                    </optgroup>
                    <optgroup label="Volumen">
                        <option value="Volumen Brasile√±o 2D">Volumen Brasile√±o 2D - s/80</option>
                        <option value="Volumen Hawaiano 3D">Volumen Hawaiano 3D - s/80</option>
                        <option value="Volumen Griego 4D">Volumen Griego 4D - s/80</option>
                        <option value="Volumen Egipcio 5D">Volumen Egipcio 5D - s/85</option>
                        <option value="Mega Volumen Egipcio 6D">Mega Volumen Egipcio 6D - s/110</option>
                    </optgroup>
                    <optgroup label="Cejas">
                        <option value="Visagismo">Visagismo - s/10</option>
                        <option value="Depilaci√≥n con cera">Depilaci√≥n con cera - s/15</option>
                        <option value="Laminado de cejas">Laminado de cejas - s/35</option>
                        <option value="Pigmentaci√≥n con henna">Pigmentaci√≥n con henna - s/35</option>
                    </optgroup>
                    <optgroup label="Paquetes Especiales">
                        <option value="Paquete 1: Lifting + Laminado">Paquete 1: Lifting + Laminado - s/60</option>
                        <option value="Paquete 2: Extensiones + Visagismo">Paquete 2: Extensiones + Visagismo - s/70</option>
                        <option value="Paquete 3: Mam√° e Hija">Paquete 3: Mam√° e Hija - 25% descuento</option>
                    </optgroup>
                </select>
                
                <div class="mg-modal-note">
                    <p><i class="mg-icon">üí°</i> Duraci√≥n aproximada: <span id="serviceDuration">45 min</span></p>
                </div>
                
                <button class="mg-confirm-btn" onclick="nextStep(1)">Siguiente</button>
            </div>
            
            <!-- Secci√≥n 2: Datos del cliente -->
            <div id="step-2" class="mg-step-section">
                <div class="mg-form-group">
                    <label for="clientName" class="mg-label">Nombre completo:</label>
                    <input type="text" id="clientName" class="mg-input" placeholder="Ingresa tu nombre">
                </div>
                
                <div class="mg-form-group">
                    <label for="clientPhone" class="mg-label">Tel√©fono:</label>
                    <input type="tel" id="clientPhone" class="mg-input" placeholder="Ej. 995 904 351">
                </div>
                
                <div class="mg-form-group">
                    <label for="clientComments" class="mg-label">Observaciones (opcional):</label>
                    <textarea id="clientComments" class="mg-textarea" placeholder="¬øPrimera vez? ¬øAlguna alergia? ¬øConsultas?"></textarea>
                </div>
                
                <div class="mg-button-group">
                    <button class="mg-back-btn" onclick="prevStep(2)">Volver</button>
                    <button class="mg-confirm-btn" onclick="nextStep(2)">Siguiente</button>
                </div>
            </div>
            
            <!-- Secci√≥n 3: Resumen y confirmaci√≥n -->
            <div id="step-3" class="mg-step-section">
                <div class="mg-summary">
                    <h4>Resumen de tu reserva</h4>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Servicio:</span>
                        <span id="summaryService" class="mg-summary-value">Lifting de Pesta√±as</span>
                    </div>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Fecha:</span>
                        <span id="summaryDay" class="mg-summary-value">Mi√©rcoles 7 Mayo</span>
                    </div>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Hora:</span>
                        <span id="summaryTime" class="mg-summary-value">2:00 PM</span>
                    </div>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Duraci√≥n:</span>
                        <span id="summaryDuration" class="mg-summary-value">45 min</span>
                    </div>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Precio:</span>
                        <span id="summaryPrice" class="mg-summary-value">s/40</span>
                    </div>
                    
                    <div class="mg-summary-item">
                        <span class="mg-summary-label">Pago adelantado:</span>
                        <span id="summaryPayment" class="mg-summary-value">s/20 (50%)</span>
                    </div>
                </div>
                
                <div class="mg-payment-methods">
                    <h4>M√©todos de pago para adelanto</h4>
                    <div class="mg-payment-options">
                        <div class="mg-payment-option">
                            <input type="radio" id="yape" name="paymentMethod" checked>
                            <label for="yape">Yape</label>
                        </div>
                        <div class="mg-payment-option">
                            <input type="radio" id="plin" name="paymentMethod">
                            <label for="plin">Plin</label>
                        </div>
                        <div class="mg-payment-option">
                            <input type="radio" id="bcp" name="paymentMethod">
                            <label for="bcp">Transferencia BCP</label>
                        </div>
                    </div>
                </div>
                
                <div class="mg-modal-info">
                    <p><i class="mg-icon">‚ÑπÔ∏è</i> Para confirmar tu cita necesitamos un adelanto del 50%. Te enviaremos los datos para el pago por WhatsApp.</p>
                </div>
                
                <div class="mg-button-group">
                    <button class="mg-back-btn" onclick="prevStep(3)">Volver</button>
                    <button class="mg-confirm-btn" onclick="confirmReservation()">Confirmar Reserva</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bot√≥n scroll to top para m√≥viles -->
    <div class="mg-scroll-top" onclick="scrollToTop()">‚Üë</div>
    
    <!-- Enlace al panel admin -->
    <a href="admin.html" class="mg-admin-link" style="position: fixed; bottom: 20px; left: 20px; background: #333; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 12px; z-index: 900;">Admin</a>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Configuraci√≥n de Firebase -->
    <script>
        // Configuraci√≥n de Firebase (API compat)
        const firebaseConfig = {
          apiKey: "AIzaSyCE45asTXxtKUJHr6KPXSD33c5Aaviy5EA",
          authDomain: "mgstudio-cd929.firebaseapp.com",
          projectId: "mgstudio-cd929",
          storageBucket: "mgstudio-cd929.firebasestorage.app",
          messagingSenderId: "1093721779888",
          appId: "1:1093721779888:web:2e23c89746fa879e585575",
          measurementId: "G-KZFBBNF871"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);

        // Inicializar Firestore y exponerlo globalmente
        const db = firebase.firestore();

        // Log de confirmaci√≥n
        console.log("Firebase inicializado correctamente:", !!firebase.firestore);
    </script>
    
    <!-- C√≥digo principal de la aplicaci√≥n -->
    <script>
        // Variables para almacenar la selecci√≥n
        let selectedDay = '';
        let selectedTime = '';
        let selectedService = '';
        let clientData = {
            name: '',
            phone: '',
            comments: ''
        };

        // Datos de servicios (para mostrar duraci√≥n y precio)
        const serviceDetails = {
            'Lifting de Pesta√±as': {duration: '45 min', price: 's/40', payment: 's/20'},
            'Extensiones Cl√°sicas': {duration: '60 min', price: 's/50', payment: 's/25'},
            'Efecto R√≠mel': {duration: '70 min', price: 's/60', payment: 's/30'},
            'Efecto Mojado': {duration: '75 min', price: 's/65', payment: 's/32.50'},
            'Extensiones H√≠bridas': {duration: '90 min', price: 's/70', payment: 's/35'},
            'Volumen Brasile√±o 2D': {duration: '90 min', price: 's/80', payment: 's/40'},
            'Volumen Hawaiano 3D': {duration: '100 min', price: 's/80', payment: 's/40'},
            'Volumen Griego 4D': {duration: '110 min', price: 's/80', payment: 's/40'},
            'Volumen Egipcio 5D': {duration: '120 min', price: 's/85', payment: 's/42.50'},
            'Mega Volumen Egipcio 6D': {duration: '150 min', price: 's/110', payment: 's/55'},
            'Visagismo': {duration: '20 min', price: 's/10', payment: 's/5'},
            'Depilaci√≥n con cera': {duration: '15 min', price: 's/15', payment: 's/7.50'},
            'Laminado de cejas': {duration: '45 min', price: 's/35', payment: 's/17.50'},
            'Pigmentaci√≥n con henna': {duration: '30 min', price: 's/35', payment: 's/17.50'},
            'Paquete 1: Lifting + Laminado': {duration: '90 min', price: 's/60', payment: 's/30'},
            'Paquete 2: Extensiones + Visagismo': {duration: '80 min', price: 's/70', payment: 's/35'},
            'Paquete 3: Mam√° e Hija': {duration: '120 min', price: 'Var√≠a', payment: '50% del total'}
        };

        // Variables para el calendario
        let currentMonth = new Date();
        
        // Gesti√≥n de tabs para m√≥vil
        function showTab(tabId) {
            // Ocultar todas las secciones
            const sections = document.querySelectorAll('.mg-content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Mostrar la secci√≥n seleccionada
            document.getElementById(tabId).classList.add('active');
            
            // Actualizar las tabs
            const tabs = document.querySelectorAll('.mg-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activar la tab seleccionada
            event.currentTarget.classList.add('active');
            
            // Scroll al inicio de la secci√≥n
            window.scrollTo(0, 0);
        }

        // Abrir el modal con la informaci√≥n del d√≠a y hora
        function openModal(day, time) {
            selectedDay = day;
            selectedTime = time;
            
            document.getElementById('selectedDay').textContent = day;
            document.getElementById('selectedTime').textContent = time;
            document.getElementById('serviceModal').style.display = 'block';
            
            // Actualizar el paso activo
            updateStepUI(1);
            
            // Obtener el servicio seleccionado y actualizar duraci√≥n
            updateServiceDetails();
            
            // Bloquear scroll del body
            document.body.style.overflow = 'hidden';
        }

        // Cerrar el modal
        function closeModal() {
            document.getElementById('serviceModal').style.display = 'none';
            
            // Restaurar scroll del body
            document.body.style.overflow = 'auto';
            
            // Resetear el proceso
            resetReservationProcess();
        }

        // Resetear el proceso de reserva
        function resetReservationProcess() {
            // Resetear las secciones
            const steps = document.querySelectorAll('.mg-step-section');
            steps.forEach(step => {
                step.classList.remove('active');
            });
            
            // Activar el paso 1
            document.getElementById('step-1').classList.add('active');
            
            // Resetear el progreso
            const progressSteps = document.querySelectorAll('.mg-progress-step');
            progressSteps.forEach(step => {
                step.classList.remove('active', 'completed');
            });
            progressSteps[0].classList.add('active');
            
            // Resetear los datos del cliente
            document.getElementById('clientName').value = '';
            document.getElementById('clientPhone').value = '';
            document.getElementById('clientComments').value = '';
            
            // Resetear los datos de selecci√≥n
            clientData = {
                name: '',
                phone: '',
                comments: ''
            };
        }

        // Actualizar la interfaz para el paso actual
        function updateStepUI(step) {
            // Quitar clase active de todos los pasos
            const steps = document.querySelectorAll('.mg-step-section');
            steps.forEach(s => s.classList.remove('active'));
            
            // Activar el paso actual
            document.getElementById(`step-${step}`).classList.add('active');
            
            // Actualizar la barra de progreso
            const progressSteps = document.querySelectorAll('.mg-progress-step');
            progressSteps.forEach((s, i) => {
                if (i + 1 < step) {
                    s.classList.add('completed');
                    s.classList.remove('active');
                } else if (i + 1 === step) {
                    s.classList.add('active');
                    s.classList.remove('completed');
                } else {
                    s.classList.remove('active', 'completed');
                }
            });
            
            // Si estamos en el paso 3, actualizar el resumen
            if (step === 3) {
                updateSummary();
            }
        }

        // Ir al siguiente paso
        function nextStep(currentStep) {
            // Validar dependiendo del paso
            if (currentStep === 1) {
                // Actualizar servicio seleccionado
                const serviceSelect = document.getElementById('serviceSelect');
                selectedService = serviceSelect.options[serviceSelect.selectedIndex].value;
                
                // Ir al paso 2
                updateStepUI(2);
            } else if (currentStep === 2) {
                // Validar datos del cliente
                const nameInput = document.getElementById('clientName');
                const phoneInput = document.getElementById('clientPhone');
                const commentsInput = document.getElementById('clientComments');
                
                if (!nameInput.value.trim()) {
                    alert('Por favor, ingresa tu nombre');
                    nameInput.focus();
                    return;
                }
                
                if (!phoneInput.value.trim()) {
                    alert('Por favor, ingresa tu n√∫mero de tel√©fono');
                    phoneInput.focus();
                    return;
                }
                
                // Guardar datos del cliente
                clientData.name = nameInput.value.trim();
                clientData.phone = phoneInput.value.trim();
                clientData.comments = commentsInput.value.trim();
                
                // Ir al paso 3
                updateStepUI(3);
            }
        }

        // Ir al paso anterior
        function prevStep(currentStep) {
            updateStepUI(currentStep - 1);
        }

        // Actualizar detalles del servicio seleccionado
        function updateServiceDetails() {
            const serviceSelect = document.getElementById('serviceSelect');
            const serviceName = serviceSelect.options[serviceSelect.selectedIndex].value;
            
            if (serviceDetails[serviceName]) {
                document.getElementById('serviceDuration').textContent = serviceDetails[serviceName].duration;
            } else {
                document.getElementById('serviceDuration').textContent = '60 min';
            }
        }

        // Actualizar el resumen antes de confirmar
        function updateSummary() {
            const serviceSelect = document.getElementById('serviceSelect');
            const serviceName = serviceSelect.options[serviceSelect.selectedIndex].value;
            
            document.getElementById('summaryService').textContent = serviceName;
            document.getElementById('summaryDay').textContent = selectedDay;
            document.getElementById('summaryTime').textContent = selectedTime;
            
            if (serviceDetails[serviceName]) {
                document.getElementById('summaryDuration').textContent = serviceDetails[serviceName].duration;
                document.getElementById('summaryPrice').textContent = serviceDetails[serviceName].price;
                document.getElementById('summaryPayment').textContent = serviceDetails[serviceName].payment + ' (50%)';
            } else {
                document.getElementById('summaryDuration').textContent = '60 min';
                document.getElementById('summaryPrice').textContent = 'Consultar';
                document.getElementById('summaryPayment').textContent = '50% del total';
            }
        }

        // Funci√≥n para guardar una reserva en Firestore
        function confirmReservation() {
            // Obtener datos del formulario
            const serviceSelect = document.getElementById('serviceSelect');
            const serviceName = serviceSelect.options[serviceSelect.selectedIndex].value;
            
            // Validar datos del cliente
            const clientName = document.getElementById('clientName').value.trim();
            const clientPhone = document.getElementById('clientPhone').value.trim();
            const clientComments = document.getElementById('clientComments').value.trim();
            
            // Validaci√≥n b√°sica
            if (!clientName) {
                alert('Por favor, ingresa tu nombre');
                return;
            }
            
            if (!clientPhone) {
                alert('Por favor, ingresa tu n√∫mero de tel√©fono');
                return;
            }
            
            // Obtener m√©todo de pago seleccionado
            let paymentMethod = 'Yape';
            if (document.getElementById('plin').checked) {
                paymentMethod = 'Plin';
            } else if (document.getElementById('bcp').checked) {
                paymentMethod = 'Transferencia BCP';
            }
            
            // Generar ID √∫nico
            const reservationId = Date.now().toString();
            
            // Mostrar bot√≥n guardando...
            const confirmBtn = document.querySelector('#step-3 .mg-confirm-btn');
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Guardando...';
            
            // Crear datos de la reserva
            const reservationData = {
                fecha: selectedDay,
                hora: selectedTime,
                nombre: clientName,
                telefono: clientPhone,
                servicio: serviceName,
                estado: 'pendiente',
                comentarios: clientComments,
                metodoPago: paymentMethod,
                fechaCreacion: new Date().toISOString()
            };
            
            console.log("Intentando guardar reserva:", reservationData);
            
            // Guardar en Firestore - usamos 'reservas' como nombre de colecci√≥n
            firebase.firestore().collection('reservas').doc(reservationId)
                .set(reservationData)
                .then(() => {
                    console.log("‚úÖ Reserva guardada exitosamente");
                    
                    // Restaurar bot√≥n
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirmar Reserva';
                    
                    // Cerrar modal
                    closeModal();
                    
                    // Marcar como pendiente en la UI
                    markAsPending(selectedDay, selectedTime);
                    
                    // Crear mensaje de WhatsApp
                    let message = `Hola MG STUDIO, me gustar√≠a confirmar una cita:\n\n`;
                    message += `üë§ Nombre: ${clientName}\n`;
                    message += `üì± Tel√©fono: ${clientPhone}\n`;
                    message += `üíÖ Servicio: ${serviceName}\n`;
                    message += `üìÖ Fecha: ${selectedDay}\n`;
                    message += `‚è∞ Hora: ${selectedTime}\n`;
                    message += `üí≥ M√©todo de pago preferido: ${paymentMethod}\n`;
                    message += `üî¢ ID de reserva: #${reservationId}\n`;
                    
                    if (clientComments) {
                        message += `\nüìù Comentarios: ${clientComments}\n`;
                    }
                    
                    // Codificar el mensaje para URL
                    const encodedMessage = encodeURIComponent(message);
                    
                    // Mostrar mensaje de √©xito
                    showSuccessMessage();
                    
                    // Redireccionar a WhatsApp
                    setTimeout(() => {
                        window.open(`https://wa.me/51995904351?text=${encodedMessage}`, '_blank');
                    }, 1000);
                })
                .catch((error) => {
                    console.error("‚ùå Error al guardar reserva:", error);
                    
                    // Restaurar bot√≥n
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirmar Reserva';
                    
                    // Mostrar error espec√≠fico
                    alert(`Error al guardar la reserva: ${error.message}`);
                });
        }
        
        // Mostrar mensaje de √©xito despu√©s de la reserva
        function showSuccessMessage() {
            // Crear elemento para mensaje
            const successMsg = document.createElement('div');
            successMsg.className = 'mg-success-message';
            successMsg.innerHTML = `
                <div class="mg-success-content">
                    <div class="mg-success-icon">‚úì</div>
                    <h3>¬°Reserva en proceso!</h3>
                    <p>Te hemos redirigido a WhatsApp para finalizar tu reserva.</p>
                    <p>Recuerda realizar el pago del 50% para confirmar tu cita.</p>
                    <button onclick="this.parentElement.parentElement.remove()">Entendido</button>
                </div>
            `;
            
            // A√±adir estilos
            const style = document.createElement('style');
            style.textContent = `
                .mg-success-message {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 2000;
                    animation: fadeIn 0.3s ease;
                }
                .mg-success-content {
                    background-color: white;
                    border-radius: 15px;
                    padding: 30px 20px;
                    text-align: center;
                    max-width: 80%;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                }
                .mg-success-icon {
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background-color: #4CAF50;
                    color: white;
                    font-size: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto 15px;
                }
                .mg-success-content h3 {
                    color: #4CAF50;
                    margin-bottom: 10px;
                }
                .mg-success-content p {
                    margin-bottom: 15px;
                    color: #666;
                }
                .mg-success-content button {
                    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 25px;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .mg-success-content button:active {
                    transform: scale(0.98);
                }
            `;
            
            // A√±adir a la p√°gina
            document.body.appendChild(style);
            document.body.appendChild(successMsg);
            
            // Auto-eliminar despu√©s de 8 segundos
            setTimeout(() => {
                if (document.body.contains(successMsg)) {
                    document.body.removeChild(successMsg);
                }
                if (document.body.contains(style)) {
                    document.body.removeChild(style);
                }
            }, 8000);
        }

        // Funci√≥n para escuchar cambios en tiempo real de las reservas
        function listenForReservationChanges() {
            console.log("Iniciando escucha de cambios en reservas...");
            
            // Usar la misma colecci√≥n 'reservas' (no 'reservations')
            firebase.firestore().collection('reservas')
                .onSnapshot((snapshot) => {
                    console.log("Cambios detectados en reservas");
                    
                    snapshot.docChanges().forEach((change) => {
                        const reservation = change.doc.data();
                        console.log("Cambio en documento:", change.type, reservation);
                        
                        // Adaptar el formato de datos
                        const adaptedReservation = {
                            day: reservation.fecha,
                            time: reservation.hora,
                            status: reservation.estado === 'pendiente' ? 'pending' : 
                                   reservation.estado === 'confirmada' ? 'confirmed' : 'canceled'
                        };
                        
                        if (change.type === 'added' || change.type === 'modified') {
                            updateUIBasedOnReservation(adaptedReservation);
                        }
                    });
                }, (error) => {
                    console.error("Error al escuchar cambios en reservas:", error);
                });
        }

        // Actualizar la UI basada en una reserva
        function updateUIBasedOnReservation(reservation) {
            const { day, time, status } = reservation;
            
            // Actualizar UI seg√∫n el estado
            switch(status) {
                case 'pending':
                    markAsPending(day, time);
                    break;
                case 'confirmed':
                    markAsConfirmed(day, time);
                    break;
                case 'canceled':
                    markAsReserved(day, time); // Una cita cancelada se muestra como no disponible
                    break;
                default:
                    break;
            }
        }

        // Marcar una hora como reservada (no disponible)
        function markAsReserved(day, time) {
            const dayCards = document.querySelectorAll('.mg-day-card');
            dayCards.forEach(card => {
                if (card.getAttribute('data-day') === day) {
                    const buttons = card.querySelectorAll('.mg-time-btn');
                    buttons.forEach(btn => {
                        if (btn.textContent.includes(time)) {
                            // Eliminar todas las clases de estado
                            btn.classList.remove('mg-time-btn-available', 'mg-time-btn-reserved', 
                                                'mg-time-btn-pending', 'mg-time-btn-confirmed', 
                                                'mg-time-btn-unavailable');
                            // A√±adir clase reservada
                            btn.classList.add('mg-time-btn-reserved');
                            
                            // Cambiar el icono y deshabilitar el bot√≥n
                            btn.innerHTML = `<i>üîí</i> ${time}`;
                            btn.onclick = null;
                            btn.disabled = true;
                        }
                    });
                }
            });
        }

        // Marcar una hora como pendiente de confirmaci√≥n
        function markAsPending(day, time) {
            const dayCards = document.querySelectorAll('.mg-day-card');
            dayCards.forEach(card => {
                if (card.getAttribute('data-day') === day) {
                    const buttons = card.querySelectorAll('.mg-time-btn');
                    buttons.forEach(btn => {
                        if (btn.textContent.includes(time)) {
                            // Eliminar todas las clases de estado
                            btn.classList.remove('mg-time-btn-available', 'mg-time-btn-reserved', 
                                                'mg-time-btn-pending', 'mg-time-btn-confirmed', 
                                                'mg-time-btn-unavailable');
                            // A√±adir clase pendiente
                            btn.classList.add('mg-time-btn-pending');
                            
                            // Cambiar el icono pero mantener habilitado el bot√≥n
                            btn.innerHTML = `<i>‚è≥</i> ${time}`;
                        }
                    });
                }
            });
        }

        // Marcar una hora como confirmada
        function markAsConfirmed(day, time) {
            const dayCards = document.querySelectorAll('.mg-day-card');
            dayCards.forEach(card => {
                if (card.getAttribute('data-day') === day) {
                    const buttons = card.querySelectorAll('.mg-time-btn');
                    buttons.forEach(btn => {
                        if (btn.textContent.includes(time)) {
                            // Eliminar todas las clases de estado
                            btn.classList.remove('mg-time-btn-available', 'mg-time-btn-reserved', 
                                                'mg-time-btn-pending', 'mg-time-btn-confirmed', 
                                                'mg-time-btn-unavailable');
                            // A√±adir clase confirmada
                            btn.classList.add('mg-time-btn-confirmed');
                            
                            // Cambiar el icono y deshabilitar el bot√≥n
                            btn.innerHTML = `<i>‚úì</i> ${time}`;
                            btn.onclick = null;
                            btn.disabled = true;
                        }
                    });
                }
            });
        }

        // Filtrar horarios por d√≠a seleccionado en el calendario
        function filterByDay(day) {
            // Cambiar a la tab de horarios
            showTab('horarios');
            
            // Resaltar el d√≠a seleccionado en el calendario
            const calendarDays = document.querySelectorAll('.mg-calendar-day');
            calendarDays.forEach(calDay => {
                if (calDay.classList.contains('mg-day-selected')) {
                    calDay.classList.remove('mg-day-selected');
                }
            });
            
            // Buscar el elemento del calendario que corresponde a este d√≠a
            calendarDays.forEach(calDay => {
                if (calDay.getAttribute('data-date') === day) {
                    calDay.classList.add('mg-day-selected');
                }
            });
            
            // Mostrar u ocultar tarjetas seg√∫n el d√≠a seleccionado
            const cards = document.querySelectorAll('.mg-day-card');
            let foundCard = false;
            
            cards.forEach(card => {
                if (card.getAttribute('data-day') === day) {
                    card.style.display = 'block';
                    foundCard = true;
                    // Scroll hasta la tarjeta
                    setTimeout(() => {
                        card.scrollIntoView({ behavior: 'smooth' });
                    }, 100);
                } else {
                    card.style.display = 'none';
                }
            });
            
            // Si no hay horarios para este d√≠a, mostrar mensaje
            if (!foundCard) {
                // Puedes implementar un mensaje como "No hay horarios disponibles para esta fecha"
                console.log("No hay horarios disponibles para:", day);
            }
        }

        // Funciones para el calendario din√°mico
        function generateCalendar(date) {
            const year = date.getFullYear();
            const month = date.getMonth();
            
            // Obtener el primer d√≠a del mes
            const firstDay = new Date(year, month, 1);
            // Obtener el √∫ltimo d√≠a del mes
            const lastDay = new Date(year, month + 1, 0);
            
            // Crear array de nombres de meses
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            
            // Actualizar t√≠tulo del calendario
            document.querySelector('.month-nav span').textContent = `${monthNames[month]} ${year}`;
            
            // Obtener contenedor del calendario
            const calendarGrid = document.querySelector('.mg-calendar-grid');
            
            // Limpiar calendario anterior
            calendarGrid.innerHTML = '';
            
            // A√±adir encabezados de d√≠as de la semana
            const weekdays = ['L', 'M', 'X', 'J', 'V', 'S', 'D'];
            weekdays.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = 'mg-calendar-day mg-calendar-header';
                dayElement.textContent = day;
                calendarGrid.appendChild(dayElement);
            });
            
            // Calcular d√≠a de la semana del primer d√≠a (0 = Domingo, 1 = Lunes, ..., 6 = S√°bado)
            // Ajustar para que la semana comience en lunes (0 = Lunes, ..., 6 = Domingo)
            let firstDayOfWeek = firstDay.getDay() - 1;
            if (firstDayOfWeek < 0) firstDayOfWeek = 6; // Si es domingo (0-1=-1), ponerlo al final (6)
            
            // A√±adir d√≠as vac√≠os al principio
            for (let i = 0; i < firstDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'mg-calendar-day mg-day-empty';
                calendarGrid.appendChild(emptyDay);
            }
            
            // Fecha actual para comparaci√≥n
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // A√±adir d√≠as del mes
            for (let i = 1; i <= lastDay.getDate(); i++) {
                const dayElement = document.createElement('div');
                const currentDate = new Date(year, month, i);
                
                // Clases base
                dayElement.className = 'mg-calendar-day';
                dayElement.textContent = i;
                
                // Si el d√≠a es anterior a hoy, marcarlo como pasado
                if (currentDate < today) {
                    dayElement.classList.add('mg-day-past');
                } 
                // Si es hoy o posterior, marcarlo como disponible
                else {
                    // Formatear la fecha para el atributo data
                    const weekdayNames = ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'];
                    const formattedDate = `${weekdayNames[currentDate.getDay()]} ${i} ${monthNames[month]}`;
                    
                    dayElement.classList.add('mg-day-available');
                    dayElement.setAttribute('data-date', formattedDate);
                    
                    // A√±adir evento click
                    dayElement.addEventListener('click', function() {
                        filterByDay(formattedDate);
                    });
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        // Navegar al mes anterior
        function prevMonth() {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            generateCalendar(currentMonth);
        }

        // Navegar al mes siguiente
        function nextMonth() {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            generateCalendar(currentMonth);
        }

        // Funci√≥n para volver arriba
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Mostrar/ocultar bot√≥n de scroll seg√∫n posici√≥n
        window.onscroll = function() {
            const scrollBtn = document.querySelector('.mg-scroll-top');
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                scrollBtn.style.display = 'block';
            } else {
                scrollBtn.style.display = 'none';
            }
        }

        // Inicializaci√≥n cuando el DOM est√° listo
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar que Firebase est√© inicializado correctamente
            if (typeof firebase === 'undefined') {
                console.error("Firebase no est√° definido. Verifica que los scripts se carguen correctamente.");
                alert("Error: No se pudo inicializar Firebase. Por favor, recarga la p√°gina.");
                return;
            }

            console.log("Firebase disponible:", !!firebase);
            console.log("Firestore disponible:", !!firebase.firestore);
            
            // Generar el calendario inicial
            generateCalendar(currentMonth);
            
            // Configurar botones de navegaci√≥n
            const prevButton = document.querySelector('#prevMonth');
            const nextButton = document.querySelector('#nextMonth');
            
            if (prevButton && nextButton) {
                prevButton.addEventListener('click', prevMonth);
                nextButton.addEventListener('click', nextMonth);
            }
            
            // Configurar eventos para cambios en el servicio
            const serviceSelect = document.getElementById('serviceSelect');
            if (serviceSelect) {
                serviceSelect.addEventListener('change', updateServiceDetails);
            }
            
            // Escuchar cambios en tiempo real
            listenForReservationChanges();
            
            // Iniciar con el primer servicio seleccionado
            updateServiceDetails();
            
            // Cerrar el modal si se hace clic fuera de √©l
            window.onclick = function(event) {
                const modal = document.getElementById('serviceModal');
                if (event.target === modal) {
                    closeModal();
                }
            }
        });
    </script>
</body>
</html>
